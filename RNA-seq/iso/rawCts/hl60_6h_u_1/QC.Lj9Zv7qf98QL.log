Starting QoRTs v1.3.6 (Compiled Tue Sep 25 11:21:46 EDT 2018)
Starting time: (Tue Jan 25 23:28:38 PST 2022)
INPUT_COMMAND(QC)
  INPUT_ARG(infile)=bam/hl60_6h_u_1.sort.bam
  INPUT_ARG(gtffile)=/data_gilbert/home/aarab/genomes/hg38/gencode.v34/gencode.v34.annotation.gtf
  INPUT_ARG(outdir)=iso/rawCts/hl60_6h_u_1/
  INPUT_ARG(stranded)=true
  INPUT_ARG(singleEnded)=true
  INPUT_ARG(nameSorted)=true
Creating Directory: iso/rawCts/hl60_6h_u_1/
Created Log File: iso/rawCts/hl60_6h_u_1//QC.Lj9Zv7qf98QL.log
Starting QC
[Time: 2022-01-25 23:28:38] [Mem usage: [35MB / 2147MB]] [Elapsed Time: 00:00:00.0000]
QoRTs is Running in single-end mode.
Note: read-sorting is irrelevant in single-ended mode.
No parameter --genomeFA found.
Running functions: CigarOpDistribution, GCDistribution, GeneCalcs, JunctionCalcs, NVC, 
        QualityScoreDistribution, StrandCheck, chromCounts, 
        cigarLocusCounts, readLengthDistro, writeBiotypeCounts, 
        writeClippedNVC, writeDESeq, writeDEXSeq, writeGeneBody, 
        writeGeneCounts, writeGenewiseGeneBody, 
        writeJunctionSeqCounts, writeKnownSplices, 
        writeNovelSplices, writeSpliceExon
Checking first 10000 reads. Checking SAM file for formatting errors...
   Stats on the first 10000 reads:
        Num Reads Primary Map:    5407
        Num Reads Paired-ended:   0
        Num Reads mapped pair:    0
        Num Pair names found:     0
        Num Pairs matched:        0
        Read Seq length:          51 to 51
        Unclipped Read length:    51 to 51
        Final maxReadLength:      51
        maxPhredScore:            41
        minPhredScore:            2
Done checking first 10000 reads. No major problems detected!
SAMRecord Reader Generated. Read length: 51.
[Time: 2022-01-25 23:28:39] [Mem usage: [267MB / 2684MB]] [Elapsed Time: 00:00:01.0713]
> Init GeneCalcs Utility
> Init NVC utility
> Init CigarOpDistribution Utility
> Init QualityScoreDistribution Utility
> Init GC counts Utility
> Init JunctionCalcs utility
Compiling flat feature annotation, internally in memory...
FlatteningGtf: starting...(2022-01-25 23:29:24)
    FlatteningGtf: gtf file read complete.(2022-01-25 23:30:29)
    FlatteningGtf: Splice Junction Map read.(2022-01-25 23:30:31)
    FlatteningGtf: gene Sets generated.(2022-01-25 23:30:33)
    FlatteningGtf: Aggregate Sets built.
    FlatteningGtf: Compiling Aggregate Info . . . (2022-01-25 23:30:33)
    FlatteningGtf: Finished Compiling Aggregate Info. (2022-01-25 23:30:34)
    FlatteningGtf: Iterating through the step-vector...(2022-01-25 23:30:34)
    FlatteningGtf: Adding the aggregate genes themselves...(2022-01-25 23:30:36)
    FlatteningGtf: Iterating through the splice junctions...(2022-01-25 23:30:36)
    FlatteningGtf: Sorting the aggregate genes...(2022-01-25 23:30:38)
    FlatteningGtf: Folding the FlatGtfLine iterator...(2022-01-25 23:30:38)
    FlatteningGtf: Features Built.(2022-01-25 23:30:38)
Internal flat feature annotation compiled!
length of knownSpliceMap after instantiation: 383654
length of knownCountMap after instantiation: 383654
> Init StrandCheck Utility
> Init chromCount Utility
> Init qcCigarLocusCounts Utility
> Init MinorUtils Utility
QC Utilities Generated!
[Time: 2022-01-25 23:30:43] [Mem usage: [4071MB / 11GB]] [Elapsed Time: 00:02:05.0366]
helper_calculateGeneAssignmentMap_strict. Found: 60669 genes in the supplied annotation.
helper_calculateGeneAssignmentMap_strict. Found: 6594 genes with ambiguous segments.
helper_calculateGeneAssignmentMap_strict. Found: 54075 genes after first-pass filtering
making makeGeneIntervalMap for geneBody calculations. Found: 54075 acceptable genes for gene-body analysis.
..........[1000000 Read-Pairs processed] [Time: 2022-01-25 23:31:53] 
..........[2000000 Read-Pairs processed] [Time: 2022-01-25 23:32:25] 
..........[3000000 Read-Pairs processed] [Time: 2022-01-25 23:32:55] 
..........[4000000 Read-Pairs processed] [Time: 2022-01-25 23:33:29] 
..........[5000000 Read-Pairs processed] [Time: 2022-01-25 23:34:02] 
..........[6000000 Read-Pairs processed] [Time: 2022-01-25 23:34:35] 
..........[7000000 Read-Pairs processed] [Time: 2022-01-25 23:35:05] 
..........[8000000 Read-Pairs processed] [Time: 2022-01-25 23:35:35] 
..........[9000000 Read-Pairs processed] [Time: 2022-01-25 23:36:05] 
..........[10000000 Read-Pairs processed] [Time: 2022-01-25 23:36:34] 
..........[11000000 Read-Pairs processed] [Time: 2022-01-25 23:37:03] 
..........[12000000 Read-Pairs processed] [Time: 2022-01-25 23:37:36] 
..........[13000000 Read-Pairs processed] [Time: 2022-01-25 23:38:05] 
..........[14000000 Read-Pairs processed] [Time: 2022-01-25 23:38:34] 
..........[15000000 Read-Pairs processed] [Time: 2022-01-25 23:39:03] 
..........[16000000 Read-Pairs processed] [Time: 2022-01-25 23:39:32] 
..........[17000000 Read-Pairs processed] [Time: 2022-01-25 23:40:01] 
.....
Finished reading SAM. Read: 17549151 reads/read-pairs.
Finished reading SAM. Used: 13561310 reads/read-pairs.
[Time: 2022-01-25 23:40:17] [Mem usage: [8GB / 11GB]] [Elapsed Time: 00:11:39.0075]
> Read Stats:
>   READ_PAIR_OK                   13561310
>   TOTAL_READ_PAIRS               17549151
>   DROPPED_NOT_PROPER_PAIR        -1
>   DROPPED_READ_FAILS_VENDOR_QC   0
>   DROPPED_MARKED_NOT_VALID       0
>   DROPPED_CHROMS_MISMATCH        -1
>   DROPPED_PAIR_STRANDS_MISMATCH  -1
>   DROPPED_IGNORED_CHROMOSOME     0
>   DROPPED_NOT_UNIQUE_ALIGNMENT   3987841
>   DROPPED_NO_ALN_BLOCKS   0
>   DROPPED_NOT_MARKED_RG   -1
Pre-alignment read count unknown (Set --seqReadCt or --rawfastq)
Writing Output...
DEBUG NOTE: IncludeGenesSet.size: 54075
DEBUG NOTE: sortedReadCountSeq.size: 13959
DEBUG NOTE: coverageThresholds: 6979;10469;12563;13959
DEBUG NOTE: coverageSpans: [(0,6979);(6979,10469);(10469,12563);(12563,13959)]
DEBUG NOTE:	[1.bottomHalf][0.5] = [0,6979]
DEBUG NOTE:	[2.upperMidQuartile][0.75] = [6979,10469]
DEBUG NOTE:	[3.75to90][0.9] = [10469,12563]
DEBUG NOTE:	[4.high][1.0] = [12563,13959]
      (DEBUG) Generating Biotype Map [2022-01-25 23:40:18]
      (DEBUG) Extracted gene BioType using key "gene_biotype".
              Found 0 types: []
      (DEBUG) Finished Biotype Map [2022-01-25 23:41:36]
length of knownCountMap after run: 383654
WARNING: The data appears to be follow the fr_secondStrand rule, but
         QoRTs ran in fr_firstStrand mode!
      Are you sure that the data follows the fr_firstStrand rule?
      Under the fr_firstStrand rule, the first read aligns to the strand
      opposite the original RNA transcript, and the second read aligns to
      the same strand as the original RNA transcript.
      If the data follows the fr_secondStrand rule, you should probably
      re-run QoRTs with the "--stranded" and "--stranded_fr_secondstrand" options.
QoRTs completed WITH WARNINGS! See log for details.
Done.
Time spent on setup:           00:02:05.0366
Time spent on SAM iteration:   00:09:33.0709
                               (0.5441858697323877 minutes per million read-pairs)
                               (0.7042092541207302 minutes per million read-pairs used)
Time spent on file output:     00:01:28.0025
Total runtime:                 00:13:07.0100
Done. (Tue Jan 25 23:41:45 PST 2022)
