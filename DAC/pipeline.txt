STAR --outSAMtype BAM SortedByCoordinate --readFilesCommand zcat --runThreadN 12 --sjdbGTFfile /avicenna/genomes/hg38/hg38_genes.gtf  --genomeDir /avicenna/genomes/hg38 --readFilesIn 120h_DMSO_rep1.fastq.gz --outFileNamePrefix 120h_DMSO_rep1_
STAR --outSAMtype BAM SortedByCoordinate --readFilesCommand zcat --runThreadN 12 --sjdbGTFfile /avicenna/genomes/hg38/hg38_genes.gtf  --genomeDir /avicenna/genomes/hg38 --readFilesIn 120h_DMSO_rep2.fastq.gz --outFileNamePrefix 120h_DMSO_rep2_
STAR --outSAMtype BAM SortedByCoordinate --readFilesCommand zcat --runThreadN 12 --sjdbGTFfile /avicenna/genomes/hg38/hg38_genes.gtf  --genomeDir /avicenna/genomes/hg38 --readFilesIn 6h_DMSO_rep1.fastq.gz --outFileNamePrefix 6h_DMSO_rep1_
STAR --outSAMtype BAM SortedByCoordinate --readFilesCommand zcat --runThreadN 12 --sjdbGTFfile /avicenna/genomes/hg38/hg38_genes.gtf  --genomeDir /avicenna/genomes/hg38 --readFilesIn 6h_DMSO_rep2.fastq.gz --outFileNamePrefix 6h_DMSO_rep2_
STAR --outSAMtype BAM SortedByCoordinate --readFilesCommand zcat --runThreadN 12 --sjdbGTFfile /avicenna/genomes/hg38/hg38_genes.gtf  --genomeDir /avicenna/genomes/hg38 --readFilesIn 72h_DMSO_rep1.fastq.gz --outFileNamePrefix 72h_DMSO_rep1_
STAR --outSAMtype BAM SortedByCoordinate --readFilesCommand zcat --runThreadN 12 --sjdbGTFfile /avicenna/genomes/hg38/hg38_genes.gtf  --genomeDir /avicenna/genomes/hg38 --readFilesIn 72h_DMSO_rep2.fastq.gz --outFileNamePrefix 72h_DMSO_rep2_
STAR --outSAMtype BAM SortedByCoordinate --readFilesCommand zcat --runThreadN 12 --sjdbGTFfile /avicenna/genomes/hg38/hg38_genes.gtf  --genomeDir /avicenna/genomes/hg38 --readFilesIn 120h_treated_rep1.fastq.gz --outFileNamePrefix 120h_treated_rep1_
STAR --outSAMtype BAM SortedByCoordinate --readFilesCommand zcat --runThreadN 12 --sjdbGTFfile /avicenna/genomes/hg38/hg38_genes.gtf  --genomeDir /avicenna/genomes/hg38 --readFilesIn 120h_treated_rep2.fastq.gz --outFileNamePrefix 120h_treated_rep2_
STAR --outSAMtype BAM SortedByCoordinate --readFilesCommand zcat --runThreadN 12 --sjdbGTFfile /avicenna/genomes/hg38/hg38_genes.gtf  --genomeDir /avicenna/genomes/hg38 --readFilesIn 6h_treated_rep1.fastq.gz --outFileNamePrefix 6h_treated_rep1_
STAR --outSAMtype BAM SortedByCoordinate --readFilesCommand zcat --runThreadN 12 --sjdbGTFfile /avicenna/genomes/hg38/hg38_genes.gtf  --genomeDir /avicenna/genomes/hg38 --readFilesIn 6h_treated_rep2.fastq.gz --outFileNamePrefix 6h_treated_rep2_
STAR --outSAMtype BAM SortedByCoordinate --readFilesCommand zcat --runThreadN 12 --sjdbGTFfile /avicenna/genomes/hg38/hg38_genes.gtf  --genomeDir /avicenna/genomes/hg38 --readFilesIn 72h_treated_rep1.fastq.gz --outFileNamePrefix 72h_treated_rep1_
STAR --outSAMtype BAM SortedByCoordinate --readFilesCommand zcat --runThreadN 12 --sjdbGTFfile /avicenna/genomes/hg38/hg38_genes.gtf  --genomeDir /avicenna/genomes/hg38 --readFilesIn 72h_treated_rep2.fastq.gz --outFileNamePrefix 72h_treated_rep2_
cufflinks -p 12 --library-type fr-secondstrand --no-effective-length-correction -G /avicenna/genomes/hg38/hg38_genes.gtf -o 120h_DMSO_rep1_cufflink 120h_DMSO_rep1.bam
cufflinks -p 12 --library-type fr-secondstrand --no-effective-length-correction -G /avicenna/genomes/hg38/hg38_genes.gtf -o 120h_DMSO_rep2_cufflink 120h_DMSO_rep2.bam
cufflinks -p 12 --library-type fr-secondstrand --no-effective-length-correction -G /avicenna/genomes/hg38/hg38_genes.gtf -o 6h_DMSO_rep1_cufflink 6h_DMSO_rep1.bam
cufflinks -p 12 --library-type fr-secondstrand --no-effective-length-correction -G /avicenna/genomes/hg38/hg38_genes.gtf -o 6h_DMSO_rep2_cufflink 6h_DMSO_rep2.bam
cufflinks -p 12 --library-type fr-secondstrand --no-effective-length-correction -G /avicenna/genomes/hg38/hg38_genes.gtf -o 72h_DMSO_rep1_cufflink 72h_DMSO_rep1.bam
cufflinks -p 12 --library-type fr-secondstrand --no-effective-length-correction -G /avicenna/genomes/hg38/hg38_genes.gtf -o 72h_DMSO_rep2_cufflink 72h_DMSO_rep2.bam
cufflinks -p 12 --library-type fr-secondstrand --no-effective-length-correction -G /avicenna/genomes/hg38/hg38_genes.gtf -o 120h_treated_rep1_cufflink 120h_treated_rep1.bam
cufflinks -p 12 --library-type fr-secondstrand --no-effective-length-correction -G /avicenna/genomes/hg38/hg38_genes.gtf -o 120h_treated_rep2_cufflink 120h_treated_rep2.bam
cufflinks -p 12 --library-type fr-secondstrand --no-effective-length-correction -G /avicenna/genomes/hg38/hg38_genes.gtf -o 6h_treated_rep1_cufflink 6h_treated_rep1.bam
cufflinks -p 12 --library-type fr-secondstrand --no-effective-length-correction -G /avicenna/genomes/hg38/hg38_genes.gtf -o 6h_treated_rep2_cufflink 6h_treated_rep2.bam
cufflinks -p 12 --library-type fr-secondstrand --no-effective-length-correction -G /avicenna/genomes/hg38/hg38_genes.gtf -o 72h_treated_rep1_cufflink 72h_treated_rep1.bam
cufflinks -p 12 --library-type fr-secondstrand --no-effective-length-correction -G /avicenna/genomes/hg38/hg38_genes.gtf -o 72h_treated_rep2_cufflink 72h_treated_rep2.bam
cuffmerge -p 12 -g /avicenna/genomes/hg38/hg38_genes.gtf -s /avicenna/genomes/hg38/hg38.fa -o /avicenna/hani/People/Luke/07182018_treatment_time-sourse-RNA-seq/cuff_merge /avicenna/hani/People/Luke/07182018_treatment_time-sourse-RNA-seq/cuff_assemblies.txt
cuffquant -p 12 --library-type fr-secondstrand -o 120h_DMSO_rep1_quant /avicenna/hani/People/Luke/07182018_treatment_time-sourse-RNA-seq/cuff_merge/merged.gtf 120h_DMSO_rep1.bam
cuffquant -p 12 --library-type fr-secondstrand -o 120h_DMSO_rep2_quant /avicenna/hani/People/Luke/07182018_treatment_time-sourse-RNA-seq/cuff_merge/merged.gtf 120h_DMSO_rep2.bam
cuffquant -p 12 --library-type fr-secondstrand -o 6h_DMSO_rep1_quant /avicenna/hani/People/Luke/07182018_treatment_time-sourse-RNA-seq/cuff_merge/merged.gtf 6h_DMSO_rep1.bam
cuffquant -p 12 --library-type fr-secondstrand -o 6h_DMSO_rep2_quant /avicenna/hani/People/Luke/07182018_treatment_time-sourse-RNA-seq/cuff_merge/merged.gtf 6h_DMSO_rep2.bam
cuffquant -p 12 --library-type fr-secondstrand -o 72h_DMSO_rep1_quant /avicenna/hani/People/Luke/07182018_treatment_time-sourse-RNA-seq/cuff_merge/merged.gtf 72h_DMSO_rep1.bam
cuffquant -p 12 --library-type fr-secondstrand -o 72h_DMSO_rep2_quant /avicenna/hani/People/Luke/07182018_treatment_time-sourse-RNA-seq/cuff_merge/merged.gtf 72h_DMSO_rep2.bam
cuffquant -p 12 --library-type fr-secondstrand -o 120h_treated_rep1_quant /avicenna/hani/People/Luke/07182018_treatment_time-sourse-RNA-seq/cuff_merge/merged.gtf 120h_treated_rep1.bam
cuffquant -p 12 --library-type fr-secondstrand -o 120h_treated_rep2_quant /avicenna/hani/People/Luke/07182018_treatment_time-sourse-RNA-seq/cuff_merge/merged.gtf 120h_treated_rep2.bam
cuffquant -p 12 --library-type fr-secondstrand -o 6h_treated_rep1_quant /avicenna/hani/People/Luke/07182018_treatment_time-sourse-RNA-seq/cuff_merge/merged.gtf 6h_treated_rep1.bam
cuffquant -p 12 --library-type fr-secondstrand -o 6h_treated_rep2_quant /avicenna/hani/People/Luke/07182018_treatment_time-sourse-RNA-seq/cuff_merge/merged.gtf 6h_treated_rep2.bam
cuffquant -p 12 --library-type fr-secondstrand -o 72h_treated_rep1_quant /avicenna/hani/People/Luke/07182018_treatment_time-sourse-RNA-seq/cuff_merge/merged.gtf 72h_treated_rep1.bam
cuffquant -p 12 --library-type fr-secondstrand -o 72h_treated_rep2_quant /avicenna/hani/People/Luke/07182018_treatment_time-sourse-RNA-seq/cuff_merge/merged.gtf 72h_treated_rep2.bam
cuffnorm -o /avicenna/hani/People/Luke/07182018_treatment_time-sourse-RNA-seq/cuffnorm -L DMSO,treatment -p 12 /avicenna/hani/People/Luke/07182018_treatment_time-sourse-RNA-seq/cuff_merge/merged.gtf ,120h_DMSO_rep1_quant/abundances.cxb,120h_DMSO_rep2_quant/abundances.cxb,6h_DMSO_rep1_quant/abundances.cxb,6h_DMSO_rep2_quant/abundances.cxb,72h_DMSO_rep1_quant/abundances.cxb,72h_DMSO_rep2_quant/abundances.cxb ,120h_treated_rep1_quant/abundances.cxb,120h_treated_rep2_quant/abundances.cxb,6h_treated_rep1_quant/abundances.cxb,6h_treated_rep2_quant/abundances.cxb,72h_treated_rep1_quant/abundances.cxb,72h_treated_rep2_quant/abundances.cxb

cuffdiff -o ./cuffdiff_6h -L DMSO,treatment -p 12 -b /avicenna/genomes/hg38/hg38.fa -u --no-effective-length-correction cuff_merge/merged.gtf 6h_DMSO_rep1_quant/abundances.cxb,6h_DMSO_rep2_quant/abundances.cxb 6h_treated_rep1_quant/abundances.cxb,6h_treated_rep2_quant/abundances.cxb


for f in *.bam;
do
out=${f/.bam/.hg38.introns.counts.txt}
echo "featureCounts --fracOverlap 1 -T 12 -P -B -C -O -t intron -g gene_id -a /avicenna/genomes/hg38/hg38_genes.Introns.gtf -o $out $f";
featureCounts --fracOverlap 1 -T 12 -P -B -C -O -t intron -g gene_id -a /avicenna/genomes/hg38/hg38_genes.Introns.gtf -o $out $f
out=${f/.bam/.hg38.consExons.counts.txt}
echo "featureCounts --fracOverlap 1 -T 12 -P -B -C -O -t exon -g gene_id -a /avicenna/genomes/hg38/hg38_genes.consExons.gtf -o $out $f";
featureCounts --fracOverlap 1 -T 12 -P -B -C -O -t exon -g gene_id -a /avicenna/genomes/hg38/hg38_genes.consExons.gtf -o $out $f
done

for f in *.counts.txt; do
out=${f/.counts.txt/.cnt}
echo "grep -v --color=never "Geneid\|Program" $f | cut -f1,7 > $out";
grep -v --color=never "Geneid\|Program" $f | cut -f1,7 > $out
done

bash ./REMBRANDTS.sh 6hr_treatment_REMB /avicenna/hani/People/Luke/07182018_treatment_time-sourse-RNA-seq/metadata_6hr.txt /avicenna/hani/People/Luke/07182018_treatment_time-sourse-RNA-seq 0.5 linear

bash ./REMBRANDTS.sh 72hr_treatment_REMB /avicenna/hani/People/Luke/07182018_treatment_time-sourse-RNA-seq/metadata_72hr.txt /avicenna/hani/People/Luke/07182018_treatment_time-sourse-RNA-seq 0.5 linear

bash ./REMBRANDTS.sh 120hr_treatment_REMB /avicenna/hani/People/Luke/07182018_treatment_time-sourse-RNA-seq/metadata_120hr.txt /avicenna/hani/People/Luke/07182018_treatment_time-sourse-RNA-seq 0.5 linear
